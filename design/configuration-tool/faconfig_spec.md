# .faconfig File Format Specification

Version: 1.0

## Overview
The `.faconfig` file is a JSON-based configuration file that defines a fire alarm system's device configuration and cause-and-effect logic. It is generated by the Configuration Tool and imported by the Alarm Simulator.

## File Extension
`.faconfig` (internally JSON)

## Schema

```json
{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "type": "object",
  "required": ["version", "projectName", "createdAt", "devices", "zones", "causeEffect"],
  "properties": {
    "version": { "type": "string", "const": "1.0" },
    "projectName": { "type": "string", "maxLength": 100 },
    "createdAt": { "type": "string", "format": "date-time" },
    "devices": { "type": "array", "items": { "$ref": "#/$defs/device" } },
    "zones": { "$ref": "#/$defs/zones" },
    "causeEffect": { "type": "array", "items": { "$ref": "#/$defs/ceRule" } }
  }
}
```

## Field Definitions

### Root Object

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `version` | string | Yes | Format version, always "1.0" |
| `projectName` | string | Yes | Human-readable project name |
| `createdAt` | string | Yes | ISO 8601 timestamp of creation |
| `devices` | array | Yes | List of configured devices |
| `zones` | object | Yes | Detection and alarm zone definitions |
| `causeEffect` | array | Yes | Cause & Effect rules |

### Device Object

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `address` | string | Yes | Device address (e.g., "A.001.001") |
| `type` | string | Yes | One of: "detector", "mcp", "sounder" |
| `subType` | string | No | e.g., "heat-multi", "optical", "bell" |
| `location` | string | Yes | Room/area name |
| `zone` | string | Yes | Zone ID reference (e.g., "DZ-01") |
| `label` | string | No | User-friendly display label |

### Zones Object

| Field | Type | Description |
|-------|------|-------------|
| `detection` | array | Detection zones (inputs) |
| `alarm` | array | Alarm zones (outputs) |

### Zone Entry

| Field | Type | Description |
|-------|------|-------------|
| `id` | string | Unique zone ID (e.g., "DZ-01") |
| `name` | string | Human-readable zone name |

### Cause & Effect Rule

| Field | Type | Description |
|-------|------|-------------|
| `id` | string | Unique rule ID |
| `condition` | object | Trigger condition |
| `outputs` | array | Device addresses to activate |
| `delay` | number | Delay in seconds before activation |

### Condition Object

| Field | Type | Description |
|-------|------|-------------|
| `type` | string | "OR" or "AND" |
| `inputs` | array | Device addresses that trigger this rule |

## Example

```json
{
  "version": "1.0",
  "projectName": "Office Building Floor 1",
  "createdAt": "2025-12-17T18:00:00Z",
  
  "devices": [
    {
      "address": "A.001.001",
      "type": "detector",
      "subType": "heat-multi",
      "location": "Office 1",
      "zone": "DZ-01",
      "label": "Office 1 Detector"
    },
    {
      "address": "A.001.002",
      "type": "detector",
      "subType": "heat-multi",
      "location": "Office 2",
      "zone": "DZ-01",
      "label": "Office 2 Detector"
    },
    {
      "address": "A.001.003",
      "type": "mcp",
      "location": "Public Area",
      "zone": "DZ-01",
      "label": "Main MCP"
    },
    {
      "address": "A.001.004",
      "type": "sounder",
      "location": "Public Area",
      "zone": "AZ-01",
      "label": "Public Sounder"
    }
  ],
  
  "zones": {
    "detection": [
      { "id": "DZ-01", "name": "Ground Floor Detection" }
    ],
    "alarm": [
      { "id": "AZ-01", "name": "Ground Floor Alarm" }
    ]
  },
  
  "causeEffect": [
    {
      "id": "rule-001",
      "condition": {
        "type": "OR",
        "inputs": ["A.001.001", "A.001.002", "A.001.003"]
      },
      "outputs": ["A.001.004"],
      "delay": 0
    }
  ]
}
```

## Notes

1. **Device Address Format**: Following AutroSafe convention: `{Loop}.{Group}.{Device}`
2. **Zone Prefixes**: Detection zones use "DZ-", Alarm zones use "AZ-"
3. **OR vs AND Logic**: 
   - OR: Any single input triggers outputs
   - AND: All inputs must trigger within a time window
4. **Delay**: Time in seconds from condition met to output activation
